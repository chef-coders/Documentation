% REVIEW: neue Features einfügen und ausreichend erklären. Bilder und Referenzen.
\section{Anwendung}\label{sec:features}

\subsection{Start}\label{subsec:start}

Beim Öffnen der Anwendung wird die Main-Activity gestartet.

Es wird geprüft, ob sich in den Shared-Preferences des Android-Geräts bereits ein gültiges User-Token und eine passende User-Id befindet.
Ist dies der Fall wird der Benutzer anhand dieser eingeloggt.
Andernfalls öffnet sich zunächst eine Login-Activity.

Es wird ein neuer Nutzer auf Basis der in der Oberfläche eingegebenen Anmeldedaten (Name, E-Mail, Adminflag, siehe Abbildung ~\ref{loginscreen}) erstellt.
Das User-Token wird für die weitere Verwendung in den Shared-Preferences zwischengespeichert.
Die Login-Activity schließt sich wieder.

Sowohl im Fall des automatischen Logins, als auch nach der Anmeldung in der Login-Activity, öffnet sich dann das Shop-Fragment in der Main-Activity.

% Bild vom Login-Screen mit Erklärung
\cfigure{figures/screen_placeholder.png}{login-screen}{\label{loginscreen}}

\subsection{Aufbau der Main-Activity} \label{subsec:main-activity}

% Fragmente werden ausgetauscht, Toolbar fest (mit Bild, welches Schema zeigt)

\subsection{Navigation in der Main-Activity} \label{subsec:navigation}

Mittels des Kontext-Menu-Button in der oberen, linken Bildschirmecke oder durch Wischen nach Rechts erscheint ein Navigation Drawer.

Im oberen Bereich des Navigation Drawers befinden sich Informationen zum Benutzer, nämlich der Nutzernamen, dessen Email-Adresse und Guthaben.
Falls der Nutzer ein Administrator ist, wird dies hinter dem Namen angezeigt.
Über den Stift-Button auf der rechten Seite, wird der Benutzer Bearbeiten-Screen geöffnet.
Dieser ermöglichst das Bearbeiten des eigene Benutzer-Profils.

Darunter zeigen sich viele Buttons, mit denen zu den Screens der App navigiert werden kann:

\begin{itemize}
	\item Shop-Button: Bei einem Klick erfolgt eine Weiterleitung auf den Shop-Screen.

	\item Einkaufs Historie-Button: Bei einem Klick auf diesen Eintrag erfolgt eine Weiterleitung auf einen Screen, in welchem alle vergangenen Einkäufe nach Datum und Zeit sortiert aufgelistet werden (siehe Abbildung ~\ref{purchases}).

	\item Nutzer-Button (Administrator): Dieser Button ist nur verfügbar, wenn der Benutzer ein Administrator ist.
	Klickt der Benutzer auf diesen Button, öffnet sich der Nutzer-Screen, der eine Liste aller Nutzer zeigt.

	\item Statistiken-Button: Wird dieser Button geklickt, öffnet sich der Statistiken-Screen, der Statistiken zum Verhalten des Benutzers liefert.

	\item Einstellungen-Button: Über diesen Button kann der Einstellungen-Screen geöffnet werden.
	In diesem kann ein Dunkel-Modus aktiviert werden.

	\item Logout-Button: Bei einem Klick auf diesen Eintrag werden die in den Shared-Preferences gespeicherten Anmeldedaten gelöscht.
	Er wird zum Login-Screen weitergeleitet, um sich einen neuen Account zu erstellen.
	Auf Grund des Designs des REST-Servers ist eine erneute Anmeldung nicht möglich.
\end{itemize}

\subsection{Bearbeiten des eigenen Nutzers} \label{subsec:edit-user}

\subsection{Shop-Screen}\label{subsec:shop-screen}

Nach erfolgreicher Anmeldung erfolgt eine Weiterleitung auf den Main-Screen.
Dieser zeigt eine Liste der kaufbaren Gegenstände (siehe Abbildung ~\ref{mainscreen}).

% Bild vom Main-Screen mit Item-Liste, evtl. Erklärungen anpassen
\cfigure{figures/screen_placeholder.png}{Haupt-Screen}{\label{mainscreen}}

Ein Eintrag in dieser Liste enthält folgende Komponenten:

\begin{itemize}
	\item Den Namen des ausgewählten Gegenstands

	\item Den Preis für einen Gegenstande des ausgewählten Typs

	\item Die ausgewählte Anzahl der Gegenstände des ausgewählten Typs, welche man kaufen möchte.
	Sie erhöht sich mit jedem Klick auf den Eintrag.
	Wischt man hingegen von rechts nach links über den Eintrag, so wird die ausgewählte Anzahl auf 0 gesetzt.
	Die Anzahl wird nur angezeigt, wenn sie größer als 0 ist.

	\item Der Gesamtpreis für den Gegenstandstyp.
	Hierbei handelt es sich um den Kumulierten Preis (ausgewählte Anzahl $\cdot$ Preis) des Gegenstands.
	Dieser wird nur angezeigt, wenn mehr als ein Gegenstand des ausgewählten Typs verlangt wird.

	\item verfügbare Anzahl: Zeigt an, wie viele Gegenstände des ausgewählten Typs gekauft werden können.
	Sie kann aufgrund des Design der REST-API negativ werden.
\end{itemize}

Die Liste ist nach der Art der Gegenstände sortiert (Beispiel: Wasser, Saft, \ldots).

\subsubsection{Artikel zum Einkaufswagen hinzufügen} \label{subsubsec:shoppingcart-add-item}

\subsubsection{Artikel aus dem Einkaufswagen entfernen} \label{subsubsec:shoppingcart-del-item}

\subsubsection{Artikel kaufen} \label{subsubsec:shop-buy}

Wenn alle gewünschten Gegenstände ausgewählt sind, wird durch einen Klick auf den Einkaufswagen-Button der Warenkorb-Screen geöffnet.
Hierbei handelt es sich um eine Darstellung nur der ausgewählten Gegenstände mit der bereits bekannten Eintragsstruktur.
Auch hier können durch einen Klick auf die Einträge Gegenstände hinzugefügt und durch Wischen über einen Eintrag alle Gegenstände dieses Typs entfernt werden.
Durch einen Klick Löschen-Button kann der komplette Einkauf gelöscht werden.
Durch einen Klick auf den Submit-Button (Haken) erscheint ein Modal-Fenster (siehe Abbildung ~\ref{shoppingCartCheck}) mit einer Abfrage, ob der Kauf durchgeführt werden soll.
Hier wird nochmals der Gesamtpreis des Einkaufs angezeigt.
Beim Klick auf \glqq yes\grqq{} wird der Kauf getätigt und man wird auf den Main-Screen weitergeleitet.
Durch ein Pop-Up am unteren Bildschrimrand wird gezeigt, dass der Kauf erfolgreich war (siehe Abbildung ~\ref{purchaseSuccess}).

% Bild des Bestätigungs-Modal, nachdem Haken im Shopping-Cart gecklickt
\cfigure{figures/screen_placeholder.png}{Letzte Bestätigung vor Kauf}{\label{shoppingCartCheck}}

% optional: Bild von Benachrichtigung nachdem Kauf erolgreich
\cfigure{figures/screen_placeholder.png}{Pop-Up nach erfolgreichem Einkauf}{\label{purchaseSuccess}}

\subsubsection{Barcode von Artikeln scannen} \label{subsubsec:shop-scan-item}

% Was passiert, wenn ein normaler Nutzer den Barcode eines Artikels einscannt
Durch einen Klick auf das Kamera-Icon in der oberen, rechten Ecke des Main-Screen (siehe Abbildung ~\ref{mainscreen}) öffnet sich die Kamera des Gerätes mit einem eingebauten Barcode-Scanner.
Hiermit kann der Nutzer Barcodes einscannen und Gegenstände anlegen, falls die ID des Barcode nicht in der Datenbank vorhanden ist und der Nutzer ein Administrator ist.
Alternativ kann der Nutzer den Gegenstand kaufen, falls dieser bereits in der Datenbank registriert ist.

\subsection{Shop-Screen (Zusätzliche Admin Funktionalitäten)} \label{subsec:shop-admin}

\subsubsection{Artikel bearbeiten} \label{subsubsec:shop-edit-items}

\subsubsection{Artikel hinzufügen} \label{subsubsec:shop-add-items}

Ist der aktuelle Nutzer als Administrator ausgezeichnet, kann er mit dem +-Knopf im oberen Banner des Main-Screen neue Gegenstände hinzufügen.
Dazu müssen folgende Daten eingegeben werden:

\begin{itemize}
	\item Der Name des zu erstellenden Gegenstands.

	\item Der Preis des zu erstellenden Gegenstands.

	\item Die Menge, in der der Gegenstand verfügbar ist.

	\item Die Art des Gegenstands.
	Hier wird aus einem Drop-Down-Menu eine Art ausgewählt.
\end{itemize}

Das Hinzufügen eines Gegenstandes benötigt eine eindeutige ID. Diese wird automatisch generiert und am oberen Bildschirmrand angezeigt (siehe Abbildung ~\ref{createItem}).

% Bild vom create-Item-Screen, evtl. Erklärungen anpassen
\cfigure{figures/screen_placeholder.png}{Erzeugung eines Gegenstandes}{\label{createItem}}

\subsubsection{Barcode von Artikeln scannen} \label{subsubsec:shop-admin-scan-item}

% Was passiert, wenn ein Artikel gescannt wird und der Nutzer ein Administrator ist

\subsection{Einkaufs Historie-Screen} \label{subsec:purchases-screen}

% Bild des Purchases-Screen, evtl. Erklärung anpassen
\cfigure{figures/screen_placeholder.png}{Liste getätigter Einkäufe}{\label{purchases-screen}}

\subsection{Nutzer-Screen (Admin Funktionalität)} \label{subsec:user-screen}

\subsection{Statistiken-Screen} \label{subsec:statistics-screen}

\subsection{Einstellungen-Screen} \label{subsec:settings-screen}

\subsection{Unterstützte Sprachen} \label{subsec:languages}
