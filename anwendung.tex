% REVIEW: neue Features einfügen und ausreichend erklären. Bilder und Referenzen.
\section{Anwendung}\label{sec:features}

\subsection{Start}\label{subsec:start}

Beim Öffnen der Anwendung wird geprüft, ob sich in den Shared-Preferences des Android-Geräts bereits ein gültiges User-Token und eine passende User-Id befindet.
Ist dies der Fall wird der Benutzer anhand dieser eingeloggt.
Andernfalls öffnet sich zunächst der Login-Screen.

Es wird ein neuer Nutzer auf Basis der in der Oberfläche eingegebenen Anmeldedaten (Name, E-Mail, Adminflag, siehe Abbildung ~\ref{loginscreen}) erstellt.
Das User-Token wird für die weitere Verwendung in den Shared-Preferences zwischengespeichert.
Der Login-Screen schließt sich wieder.

Sowohl im Fall des automatischen Logins, als auch nach der Anmeldung im Login-Screen, öffnet sich dann der Shop-Screen.

% Bild vom Login-Screen mit Erklärung
\cfigure{figures/screen_placeholder.png}{login-screen}{\label{loginscreen}}

\subsection{Navigation} \label{subsec:navigation}

Mittels des Kontext-Menu-Button in der oberen, linken Bildschirmecke des Shop-Screens oder durch Wischen nach Rechts erscheint ein Navigation Drawer.

Im oberen Bereich des Navigation Drawers befinden sich Informationen zum Benutzer (Der Nutzernamen, die Email-Adresse und das Guthaben).
Falls der Nutzer ein Administrator ist, wird dies hinter dem Namen angezeigt.
Über den Stift-Button auf der rechten Seite, wird der Nutzer-bearbeiten-Screen geöffnet.
Dieses ermöglichst das Bearbeiten des eigene Benutzer-Profils.

Darunter zeigen sich viele Buttons, mit denen zu allen Screens der App navigiert werden kann:

\begin{itemize}
	\item Shop-Button: Der Shop-Screen wird geöffnet.
	Dies ist der zentrale Screen der App, da hier Artikel gekauft werden können.

	\item Einkaufs Historie-Button: Der Einkaufs-Historie-Screen öffnet sich, in welchem alle vergangenen Einkäufe nach Datum und Zeit sortiert aufgelistet werden (siehe Abbildung ~\ref{purchases}).

	\item Nutzer-Button (Administrator): Dieser Button ist nur verfügbar, wenn der Benutzer ein Administrator ist.
	Klickt er auf diesen Button, öffnet sich das Nutzer-Framgent, das die Liste aller Nutzer zeigt.

	\item Statistiken-Button: Wird dieser Button geklickt, öffnet sich der Statistiken-Screen, welches Statistiken zum Verhalten des Benutzers liefert.

	\item Einstellungen-Button: Über diesen Button kann der Einstellungen-Screen geöffnet werden.
	In diesem kann ein Dunkel-Modus aktiviert werden.

\end{itemize}

Der unterste Button, der mit dem Label "Logout-Button" versehen ist, hat nichts mit der Navigation zwischen Screens zu tun.
Bei einem Klick auf diesen Eintrag werden die in den Shared-Preferences gespeicherten Anmeldedaten gelöscht.
Er wird zum Login-Screen weitergeleitet, um sich einen neuen Account zu erstellen.
Auf Grund des Designs des REST-Servers ist eine erneute Anmeldung nicht möglich.

\subsection{Nutzer-bearbeiten-Screen} \label{subsec:edit-user-screen}

\subsection{Shop-Screen}\label{subsec:shop-screen}

Nach erfolgreicher Anmeldung erfolgt eine Weiterleitung auf den Shop-Screen.
Dieser zeigt eine Liste der kaufbaren Gegenstände (siehe Abbildung ~\ref{mainscreen}).

% Bild vom Main-Screen mit Item-Liste, evtl. Erklärungen anpassen
\cfigure{figures/screen_placeholder.png}{Haupt-Screen}{\label{mainscreen}}

Ein Eintrag in dieser Liste enthält folgende Komponenten:

\begin{itemize}
	\item Den Namen des ausgewählten Gegenstands

	\item Den Preis für einen Gegenstande des ausgewählten Typs

	\item Die ausgewählte Anzahl der Gegenstände des ausgewählten Typs, welche man kaufen möchte.
	Sie erhöht sich mit jedem Klick auf den Eintrag.
	Wischt man hingegen von rechts nach links über den Eintrag, so wird die ausgewählte Anzahl auf 0 gesetzt.
	Die Anzahl wird nur angezeigt, wenn sie größer als 0 ist.

	\item Der Gesamtpreis für den Gegenstandstyp.
	Hierbei handelt es sich um den Kumulierten Preis (ausgewählte Anzahl $\cdot$ Preis) des Gegenstands.
	Dieser wird nur angezeigt, wenn mehr als ein Gegenstand des ausgewählten Typs verlangt wird.

	\item verfügbare Anzahl: Zeigt an, wie viele Gegenstände des ausgewählten Typs gekauft werden können.
	Sie kann aufgrund des Design der REST-API negativ werden.
\end{itemize}

Die Liste ist nach der Art der Gegenstände sortiert (Beispiel: Wasser, Saft, \ldots).

\subsubsection{Artikel zum Einkaufswagen hinzufügen} \label{subsubsec:shoppingcart-add-item}

Tippt der Benutzer auf einen Listeintrag, z.B. Zitronenlimonade, wird ein Exemplar in den Warenkorb gelegt.
Der Benutzer kann einen Listeintrag so oft hinzufügen, wie Exemplare verfügbar sind.
Die Anzahl, der von einem Typ zum Einkaufswagen hinzugefügten Exemplare wird auf dem Listeintrag abgebildet.
Sind zwei oder mehr Exemplare eines Artikels im Warenkorb wird der Gesamtpreis der ausgewählten Exemplare des Artikels auf dem Listeintrag abgebildet.

\subsubsection{Artikel aus dem Einkaufswagen entfernen} \label{subsubsec:shoppingcart-del-item}

Artikel können aus dem Einkaufswagen entfernt werden, indem der entsprechende Listeintrag nach links gewischt wird.
Dabei zeigt sich unter dem Listeintrag ein Mülleimer-Symbol auf dunklem Grund, welches den Vorgang verdeutlicht.
Es werden dann alle Exemplare des Artikels aus dem Warenkorb entfernt.

\subsubsection{Verhalten des Einkaufswagen-Buttons} \label{subsubsec:shoppingcart-button}

Der Einkaufswagen-Button schwebt über der Artikel-Liste.
Durch das Klicken auf diesen kann man den Einkaufswagen in einem separaten Screen betrachten und den Kauf tätigen.

Der Button zeigt sich erst, sobald sich mindestens ein Element im Warenkorb befindet.
Werden alle Elemente aus dem Warenkorb entfernt, verschwindet der Button wieder.

Befindet sich mehr als ein Element im Warenkorb, verschwindet der Einkaufswagen-Button temporär, sobald der Benutzer nach unter scrollt, damit untere Listelemente nicht vom Button verdeckt werden.
Scrollt der Benutzer nach oben, erscheint der Einkaufswagen-Button wieder.

\subsubsection{Artikel kaufen} \label{subsubsec:shop-buy}

Wenn alle gewünschten Gegenstände ausgewählt sind, wird durch einen Klick auf den Einkaufswagen-Button der Warenkorb-Screen geöffnet.
Hierbei handelt es sich um eine Darstellung nur der ausgewählten Gegenstände mit der bereits bekannten Eintragsstruktur.
Auch hier können durch einen Klick auf die Einträge Gegenstände hinzugefügt und durch Wischen über einen Eintrag alle Gegenstände dieses Typs entfernt werden.
Durch einen Klick Löschen-Button kann der komplette Einkauf gelöscht werden.
Durch einen Klick auf den Submit-Button (Haken) erscheint ein Modal-Fenster (siehe Abbildung ~\ref{shoppingCartCheck}) mit einer Abfrage, ob der Kauf durchgeführt werden soll.
Hier wird nochmals der Gesamtpreis des Einkaufs angezeigt.
Beim Klick auf \glqq yes\grqq{} wird der Kauf getätigt und man wird auf den Shop-Screen weitergeleitet.
Durch ein Pop-Up am unteren Bildschrimrand wird gezeigt, dass der Kauf erfolgreich war (siehe Abbildung ~\ref{purchaseSuccess}).

% Bild des Bestätigungs-Modal, nachdem Haken im Shopping-Cart gecklickt
\cfigure{figures/screen_placeholder.png}{Letzte Bestätigung vor Kauf}{\label{shoppingCartCheck}}

% optional: Bild von Benachrichtigung nachdem Kauf erolgreich
\cfigure{figures/screen_placeholder.png}{Pop-Up nach erfolgreichem Einkauf}{\label{purchaseSuccess}}

\subsubsection{Barcode von Artikeln scannen} \label{subsubsec:shop-scan-item}

% Was passiert, wenn ein normaler Nutzer den Barcode eines Artikels einscannt
Durch einen Klick auf das Kamera-Icon in der oberen, rechten Ecke des Shop-Screens (siehe Abbildung ~\ref{mainscreen}) öffnet sich die Kamera des Gerätes mit einem eingebauten Barcode-Scanner.
Hiermit kann der Nutzer Barcodes einscannen und Gegenstände anlegen, falls die ID des Barcode nicht in der Datenbank vorhanden ist und der Nutzer ein Administrator ist.
Alternativ kann der Nutzer den Gegenstand kaufen, falls dieser bereits in der Datenbank registriert ist.

\subsection{Shop-Screen (Zusätzliche Administrator Funktionalitäten)} \label{subsec:shop-screen-admin}

Ist der Benutzer ein Administrator, ist in der Toolbar ein Stift-Symbol zu sehen.
Mit diesem lässt sich der Bearbeitungs-Modus aktivieren.
Dann verschwindet in der Toolbar das Artikel-Scannen-Symbol und wird ersetzt durch ein Plus-Symbol.
Außerdem färbt sich die Toolbar, um zu signalisieren, dass sich der Benutzer im Bearbeitungs-Modus befindet.
Tippt der Benutzer erneut auf das Stift-Symbol, wird der Bearbeitungs-Modus deaktiviert.
Die Toolbar wird wieder blau gefärbt und das Plus-Symbol wird wieder durch das Artikel-Scannen-Symbol ersetzt.

\subsubsection{Artikel bearbeiten} \label{subsubsec:shop-edit-items}

Befindet sich der Benutzer im Bearbeiten-Modus und tippt auf einen Listeintrag, öffnet sich der Artikel-Bearbeiten-Screen.

\subsubsection{Artikel hinzufügen} \label{subsubsec:shop-add-items}

Ist der aktuelle Nutzer als Administrator ausgezeichnet, kann er mit dem +-Knopf im oberen Banner des Shop-Screens neue Gegenstände hinzufügen.
Dazu müssen folgende Daten eingegeben werden:

\begin{itemize}
	\item Der Name des zu erstellenden Gegenstands.

	\item Der Preis des zu erstellenden Gegenstands.

	\item Die Menge, in der der Gegenstand verfügbar ist.

	\item Die Art des Gegenstands.
	Hier wird aus einem Drop-Down-Menu eine Art ausgewählt.
\end{itemize}

Das Hinzufügen eines Gegenstandes benötigt eine eindeutige ID. Diese wird automatisch generiert und am oberen Bildschirmrand angezeigt (siehe Abbildung ~\ref{createItem}).

% Bild vom create-Item-Screen, evtl. Erklärungen anpassen
\cfigure{figures/screen_placeholder.png}{Erzeugung eines Gegenstandes}{\label{createItem}}

\subsubsection{Barcode von Artikeln scannen} \label{subsubsec:shop-admin-scan-item}

% Was passiert, wenn ein Artikel gescannt wird und der Nutzer ein Administrator ist

\subsection{Einkaufs-Historie-Screen} \label{subsec:purchases-screen}

% Bild des Purchases-Screen, evtl. Erklärung anpassen
\cfigure{figures/screen_placeholder.png}{Liste getätigter Einkäufe}{\label{purchases-screen}}

\subsection{Nutzer-Screen (Administrator Funktionalität)} \label{subsec:user-screen}

\subsection{Statistiken-Screen} \label{subsec:statistics-screen}
Der Statistiken-Screen ist über die Navigation verfügbar. Dieser stellt unterschiedliche Informationen für Administratoren und gewöhnliche Benutzer grafisch dar. Ein Administrator kann dort einsehen welche Artikel wie oft gekauft worden und somit einen Überblick über die verkauften Stückzahlen pro Artikel erhalten. Des weiterem wird der Betrag von allen verkauften Artikeln, der Betrag von den selbst eingekauften Artikeln, die Anzahl aller verkaufter Artikel und die Anzahl der selbst eingekauften Artikel dargestellt. Die Ansicht eines Administrators ist in Abbildung \ref{statistics-admin} zu sehen. Ein Benutzer erhält lediglich einen Überblick über seine eignen Einkäufe. Dabei kann der Benutzer für jeden Artikel die von Ihm eingekauften Stückzahlen einsehen. Des weiterem wird dem Benutzer dargestellt wie viel Geld dieser bereits ausgegeben hat und wie viele Artikel dieser insgesamt schon gekauft hat. Die Ansicht eines Nutzers ist in Abbildung \ref{statistics.user} dargestellt. Alle Beträge werden dabei in Euro angezeigt.

\cfigure{figures/statistics-admin.png}{Statistiken - Ansicht des Administrators}{\label{statistics-admin}}

\cfigure{figures/statistics-user.png}{Statistiken - Ansicht des Benutzers}{\label{statistics.user}}

\subsection{Einstellungen-Screen} \label{subsec:settings-screen}

\subsection{Unterstützte Sprachen} \label{subsec:languages}
Von der App wird derzeit Englisch und Deutsch unterstützt. Die Wahl der Sprache hängt hierbei von der Systemsprache des Smartphones ab.
